# 事件循环机制

> `javascript`是单线程的，在一个时间点下`JS`引擎只能处理一件事。

`js`任务分为**同步任务**和**异步任务**两种。这里的同步和异步不同于我们普通观念中的同步和异步：

- 同步：连贯完成一个任务。
- 异步：将任务进行分段，然后利用回调的过程来循环交替执行任务。

在异步任务准备的同时，`JS`引擎去执行其他同步任务，等到异步任务准备好了，再去执行回调。

实现这个操作事件执行时机的是**事件循环**，由一个队列组成，异步任务的回调遵循先进先出，在`JS`引擎空闲时会被循环取出。

## 宏任务和微任务

在任务队列中主要由宏任务和微任务两大类。

宏任务和微任务交替执行，形成了一个紧急任务的插队机制。 

> `setTimeout`：
>
> 如果事件到了，但是`JS`引擎还是在执行同步任务，这个回调需要等待；如果当前的事件循环的队列里有其他的回调，需要等其他的回调执行完。
>
> 即使`setTimeout 0ms`也不是立刻执行，他有一个默认最小的时间，4ms。