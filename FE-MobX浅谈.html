<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://avatars.githubusercontent.com/u/77950278?s=120&v=4"><title>MobX | 白子煜 | 个人小站</title><meta name="description" content="白子煜个人笔记">
    <link rel="modulepreload" href="/notes/assets/app.70d9e8a7.js"><link rel="modulepreload" href="/notes/assets/FE-MobX浅谈.html.39ca30bb.js"><link rel="modulepreload" href="/notes/assets/FE-MobX浅谈.html.4b58cbb6.js">
    <link rel="stylesheet" href="/notes/assets/style.42c3c254.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/notes/" class=""><!----><span class="site-name">白子煜 | 个人小站</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/notes/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://juejin.cn/user/870468941264270/posts" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/baiziyu-fe/notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/notes/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://juejin.cn/user/870468941264270/posts" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/baiziyu-fe/notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">MobX <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#什么是mobx" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是MobX"><!--[--><!--]--> 什么是MobX <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#核心理念" class="router-link-active router-link-exact-active sidebar-item" aria-label="核心理念"><!--[--><!--]--> 核心理念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#核心内容" class="router-link-active router-link-exact-active sidebar-item" aria-label="核心内容"><!--[--><!--]--> 核心内容 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#observable-state" class="router-link-active router-link-exact-active sidebar-item" aria-label="Observable State"><!--[--><!--]--> Observable State <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#action" class="router-link-active router-link-exact-active sidebar-item" aria-label="Action"><!--[--><!--]--> Action <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#computeds" class="router-link-active router-link-exact-active sidebar-item" aria-label="computeds"><!--[--><!--]--> computeds <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#reactions" class="router-link-active router-link-exact-active sidebar-item" aria-label="reactions"><!--[--><!--]--> reactions <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/notes/FE-MobX%E6%B5%85%E8%B0%88.html#参考" class="router-link-active router-link-exact-active sidebar-item" aria-label="参考"><!--[--><!--]--> 参考 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="mobx" tabindex="-1"><a class="header-anchor" href="#mobx" aria-hidden="true">#</a> MobX</h1><h2 id="什么是mobx" tabindex="-1"><a class="header-anchor" href="#什么是mobx" aria-hidden="true">#</a> 什么是<code>MobX</code></h2><p><code>MobX</code>是一种简单、可拓展的状态管理方案。虽然<code>MobX</code>本身是一个独立的库，但是就像豆浆和油条一样，他也没有想到自由有一天和<code>React</code>会如此契合。</p><h3 id="核心理念" tabindex="-1"><a class="header-anchor" href="#核心理念" aria-hidden="true">#</a> 核心理念</h3><p><strong>确保从应用状态中派生出的一切都将被自动派生出来。</strong><img src="https://zh.mobx.js.org/assets/getting-started-assets/overview.png" alt=""></p><ul><li>State：<code>MobX</code>通过<code>State</code>来驱动应用程序的数据，并且<strong>确保可以被改变的属性都被标记为<code>observale</code></strong>，当然了，前提是你需要<code>MobX</code>跟踪他们并产生对应的化学反应。</li><li>Action：主要作用于改变State。<strong>Action主要作用于帮助我们更好的组织代码，避免因为一些副作用函数导致的state篡改</strong>。</li><li>Derivations：可以理解为一些触发反应。在这里主要分为两种： <ul><li>computed Value：有点像<code>Vue</code>中的<code>Computed</code>或者是<code>React</code>中的<code>useMemo</code>，主要是期望返回一些简单的计算值。</li><li>Reactions：这里主要是用于处理一些可能会影响<code>Dom</code>更新的操作。（Reactions咋子合理并不需要产生某个结果，而是通过产生副作用来完成我们的功能）</li></ul></li></ul><p>那么<code>MobX</code>是怎么做到的呢？ <code>MobX</code>使用单项数据流，action改变state，进而触发所有的操作。 <img src="https://zh.mobx.js.org/assets/action-state-view.png" alt=""></p><ul><li>所有的derivations在state变化时<strong>自动且原子化更新</strong>，换句话说，他更重要的是观察最终的结果变化而非过程中值的变化。</li><li>derivations<strong>默认同步更新</strong>，这将确保我们的action可以安全的获得state改变的值</li><li>computed value的更新是惰性的，任何computed value不会在副作用发生之前被激活</li><li>应该始终确保computed value没有副作用（也就是确保其为纯函数），不应该使他们影响state或者其他内容。 下面的Demo使用<code>MobX</code>完成对应的功能<a href="https://codesandbox.io/embed/gracious-dream-9bbmpn?fontsize=14&amp;hidenavigation=1&amp;theme=dark" target="_blank" rel="noopener noreferrer">CodeBox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：</li></ul><iframe src="https://codesandbox.io/embed/gracious-dream-9bbmpn?fontsize=14&amp;hidenavigation=1&amp;theme=dark" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden;" title="gracious-dream-9bbmpn" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 id="核心内容" tabindex="-1"><a class="header-anchor" href="#核心内容" aria-hidden="true">#</a> 核心内容</h3><h3 id="observable-state" tabindex="-1"><a class="header-anchor" href="#observable-state" aria-hidden="true">#</a> Observable State</h3><h4 id="创建一个可观察对象" tabindex="-1"><a class="header-anchor" href="#创建一个可观察对象" aria-hidden="true">#</a> 创建一个可观察对象</h4><h5 id="手动绑定-makeobservable" tabindex="-1"><a class="header-anchor" href="#手动绑定-makeobservable" aria-hidden="true">#</a> 手动绑定（<code>makeObservable</code>）</h5><p>使用<code>makeObservable</code>手动绑定注解：</p><ul><li><code>observable</code> 定义一个存储 state 的可追踪字段。</li><li><code>action</code> 将一个方法标记为可以修改 state 的 action。</li><li><code>computed</code> 标记一个可以由 state 派生出新的值并且缓存其输出的 getter。</li></ul><h5 id="自动绑定-makeautoobservable" tabindex="-1"><a class="header-anchor" href="#自动绑定-makeautoobservable" aria-hidden="true">#</a> 自动绑定(<code>makeAutoObservable</code>)</h5><p>用于帮助你推断所有的属性，维护也更简单。</p><ul><li>所有 <em>自有</em> 属性都成为 <code>observable</code>。</li><li>所有 <code>get</code>ters 都成为 <code>computed</code>。</li><li>所有 <code>set</code>ters 都成为 <code>action</code>。</li><li>所有 <em>prototype 中的 functions</em> 都成为 <code>autoAction</code>。</li><li>所有 <em>prototype 中的 generator functions</em> 都成为 <code>flow</code>。（需要注意，generators 函数在某些编译器配置中无法被检测到，如果 flow 没有正常运行，请务必明确地指定 <code>flow</code> 注解。）</li><li>在 <code>overrides</code> 参数中标记为 <code>false</code> 的成员将不会被添加注解。例如，将其用于像标识符这样的只读字段。</li></ul><h3 id="action" tabindex="-1"><a class="header-anchor" href="#action" aria-hidden="true">#</a> Action</h3><p>action 就是任意一段修改 state 的代码。原则上，actions 总会为了对一个事件做出响应而发生。</p><ul><li><code>action</code> <em>（注解）</em></li><li><code>action(fn)</code></li><li><code>action(name, fn)</code></li></ul><p><code>action</code> 不仅仅是一个注解，更是一个高阶函数。可以使用函数将它作为一个参数来调用，在这种情况下它将会返回一个有着相同签名的使用 <code>action</code> 包装过的函数。</p><h3 id="computeds" tabindex="-1"><a class="header-anchor" href="#computeds" aria-hidden="true">#</a> computeds</h3><p>计算值采用惰性求值，会缓存其输出，并且只有当其依赖的可观察对象被改变时才会重新计算。 它们在不被任何值观察时会被暂时停用。</p><ul><li><code>computed</code> <em>（注解）</em></li><li><code>computed(options)</code> <em>（注解）</em></li><li><code>computed(fn, options?)</code></li></ul><h3 id="reactions" tabindex="-1"><a class="header-anchor" href="#reactions" aria-hidden="true">#</a> reactions</h3><p>reactions 的目的是对自动发生的副作用进行建模。 它们的意义在于为你的可观察状态创建消费者，以及每当_关联_的值发生变化时，_自动_运行副作用。</p><h4 id="autorun" tabindex="-1"><a class="header-anchor" href="#autorun" aria-hidden="true">#</a> AutoRun</h4><ul><li><code>autorun(effect: (reaction) =&gt; void)</code> Autorun 通过在_响应式上下文_运行 <code>effect</code> 来工作。在给定的函数执行期间，MobX 会持续跟踪被 effect 直接或间接_读取_过的所有可观察对象和计算值。 一旦函数执行完毕，MobX 将收集并订阅所有被读取过的可观察对象，并等待其中任意一个再次发生改变。 一旦有改变发生，<code>autorun</code> 将会再次触发，重复整个过程。 <img src="https://zh.mobx.js.org/assets/autorun.png" alt=""></li></ul><h4 id="reaction" tabindex="-1"><a class="header-anchor" href="#reaction" aria-hidden="true">#</a> Reaction</h4><ul><li><code>reaction(() =&gt; value, (value, previousValue, reaction) =&gt; { sideEffect }, options?)</code>. reaction会将参数的第一个 data 函数返回值作为第二个参数effect函数的输入值。 与 <code>autorun</code> 不同，副作用在初始化时不会自动运行，而只会在 data 表达式首次返回新值之后运行。</li></ul><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ul><li><a href="https://zh.mobx.js.org/the-gist-of-mobx.html" target="_blank" rel="noopener noreferrer"># MobX 主旨<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/baiziyu-fe/notes/master/docs/FE-MobX浅谈.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 77950278+baiziyu-fe@users.noreply.github.com">白子煜</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/notes/assets/app.70d9e8a7.js" defer></script>
  </body>
</html>
